<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>生物と時間の比較 - Stylish版</title>
<style>
  :root {
    --accent: #63e6be;
    --accent2: #89f7fe;
    --bg: #0c0f14;
    --glass: rgba(255,255,255,0.08);
    --text: #f5f5f5;
    --muted: #a0a0a0;
  }
  body {
    margin: 0;
    padding: 40px;
    font-family: "Inter", "Noto Sans JP", system-ui, sans-serif;
    background: radial-gradient(circle at top left, #1a1c25, #0c0f14 70%);
    color: var(--text);
  }
  h1 {
    font-size: 1.8rem;
    letter-spacing: 0.02em;
    text-align: center;
    margin-bottom: 10px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    color: transparent;
  }
  p.muted {
    text-align: center;
    color: var(--muted);
    margin-bottom: 40px;
    font-size: 0.9rem;
  }
  .controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 14px;
    margin-bottom: 20px;
  }
  button {
    background: var(--glass);
    border: 1px solid rgba(255,255,255,0.15);
    padding: 10px 18px;
    color: var(--text);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    backdrop-filter: blur(8px);
  }
  button:hover {
    background: rgba(99,230,190,0.2);
    transform: translateY(-1px);
    box-shadow: 0 0 10px rgba(99,230,190,0.4);
  }
  select {
    background: var(--glass);
    color: var(--text);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    padding: 6px 10px;
    backdrop-filter: blur(6px);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
    background: var(--glass);
    backdrop-filter: blur(8px);
    animation: fadeIn 0.6s ease forwards;
  }
  th, td {
    padding: 10px 12px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    text-align: left;
    font-size: 0.85rem;
  }
  th {
    background: rgba(255,255,255,0.06);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--accent2);
  }
  tr:hover {
    background: rgba(255,255,255,0.05);
  }
  .bar {
    height: 8px;
    width: 120px;
    background: rgba(255,255,255,0.08);
    border-radius: 5px;
    overflow: hidden;
  }
  .bar i {
    display: block;
    height: 100%;
    background: linear-gradient(90deg, var(--accent2), var(--accent));
    width: 0;
    border-radius: 5px;
    transition: width 1s ease;
  }
  .donut {
    width: 46px;
    height: 46px;
  }
  td svg text {
    fill: var(--muted);
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>
  <h1>生物の「時間感覚」比較（カップラーメン編）</h1>
  <p class="muted">本川達雄『ゾウの時間ネズミの時間』仮説（寿命 ∝ 体重<sup>1/4</sup> or <sup>1/3</sup>）に基づく可視化ツール</p>

  <div class="controls">
    <button id="btn3">人間の3分</button>
    <button id="btn5">人間の5分</button>
    <label>指数：</label>
    <select id="expo">
      <option value="0.25">1/4則</option>
      <option value="0.3333333333333">1/3則</option>
    </select>
  </div>

  <div id="resultArea"></div>

<script>
const species = [
  { name:'プランクトン', mass_g:1e-6, real_years:0.00011415525 },
  { name:'トウキョウトガリネズミ', mass_g:2.0, real_years:1.5 },
  { name:'ネズミ', mass_g:25.0, real_years:2.0 },
  { name:'人間', mass_g:62000.0, real_years:79.0 },
  { name:'ゾウ', mass_g:6000000.0, real_years:65.0 },
  { name:'シロナガスオオクジラ', mass_g:150000000.0, real_years:85.0 },
  { name:'シン・ゴジラ', mass_g:9.2e10, real_years:null },
];
const baseline = { mass_g:62000, life_years:79 };
function fmtMass(g){
  if(g>=1e6)return(g/1e6).toFixed(2)+' t';
  if(g>=1e3)return(g/1e3).toFixed(1)+' kg';
  return g+' g';
}
function fmtCount(x){
  if(!x)return'-';
  const n=Math.round(x);
  if(n>=1e12)return(n/1e12).toFixed(2)+'兆';
  if(n>=1e8)return(n/1e8).toFixed(2)+'億';
  if(n>=1e4)return(n/1e4).toFixed(1)+'万';
  return n.toLocaleString();
}
function fmtPercent(p){if(p==null)return'-';return p<1e-6?p.toExponential(2)+'%':p.toFixed(8)+'%';}
function percentOfLife(min,y){return y?100*min/(y*525600):null;}
function estLifeYears(m,e){return baseline.life_years*Math.pow(m/baseline.mass_g,e);}
function ramenCount(y,m){return y?y*525600/m:null;}
function frac(minutes,lifeYears){if(!lifeYears)return'-';const N=Math.round(lifeYears*525600/minutes);return '1/'+N.toLocaleString();}
function drawDonuts(){
  document.querySelectorAll('.donut').forEach(el=>{
    const p=parseFloat(el.dataset.p||0);
    const r=18,c=2*Math.PI*r,filled=c*(p/100);
    el.innerHTML=`<svg viewBox="0 0 48 48">
    <g transform="translate(24,24)">
      <circle r="${r}" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="7"/>
      <circle r="${r}" fill="none" stroke="url(#grad)" stroke-width="7"
        stroke-dasharray="${filled} ${c-filled}" stroke-linecap="round" transform="rotate(-90)"/>
      <text x="0" y="4" text-anchor="middle" font-size="8">${p<0.0001?'<0.0001%':p.toFixed(5)+'%'}</text>
    </g></svg>`;
  });
}
function render(min,exp){
  const out=document.getElementById('resultArea');
  let html=`<table><thead><tr>
  <th>生物</th><th>体重</th><th>実寿命(年)</th><th>推定寿命(年)</th>
  <th>${min}分/実寿命(%)</th><th>${min}分/推定寿命(%)</th>
  <th>分数(推定)</th><th>カップ麺回数(実?推定)</th><th>可視化</th>
  </tr></thead><tbody>`;
  species.forEach(s=>{
    const est=estLifeYears(s.mass_g,exp);
    const pReal=percentOfLife(min,s.real_years);
    const pEst=percentOfLife(min,est);
    const ramenR=ramenCount(s.real_years,min);
    const ramenE=ramenCount(est,min);
    html+=`<tr>
      <td>${s.name}</td>
      <td>${fmtMass(s.mass_g)}</td>
      <td>${s.real_years??'-'}</td>
      <td>${est.toFixed(6)}</td>
      <td>${fmtPercent(pReal)}</td>
      <td>${fmtPercent(pEst)}</td>
      <td>${frac(min,est)}</td>
      <td>${fmtCount(ramenR)}?${fmtCount(ramenE)}</td>
      <td><div class="bar"><i style="width:${Math.min(pEst*100,100)}%"></i></div>
          <div class="donut" data-p="${pEst||0}"></div></td>
    </tr>`;
  });
  html+='</tbody></table>';
  out.innerHTML=html;
  drawDonuts();
}
document.getElementById('btn3').onclick=()=>render(3,parseFloat(document.getElementById('expo').value));
document.getElementById('btn5').onclick=()=>render(5,parseFloat(document.getElementById('expo').value));
document.getElementById('expo').onchange=()=>render(3,parseFloat(document.getElementById('expo').value));
render(3,0.25);
</script>
</body>

</html>

